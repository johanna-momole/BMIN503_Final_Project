---
title: "Modeling HPV Vaccination Rates Across the U.S."
subtitle: "BMIN503/EPID600 Final Project"
author: "Johanna Momole"
format: 
  html:
    fig-width: 8
    fig-height: 6
    toc: true #make table of contents
    toc-location: left
    toc-depth: 2
editor: visual
theme: cerulean
number-sections: true
embed-resources: true
execute: 
  warning: false
  message: false
---

------------------------------------------------------------------------

## Overview {#sec-overview}

HPV vaccination is a critical tool in preventing HPV-related cancers, yet disparities in vaccination coverage persist across the U.S. This project uses the CDC's dataset, *Vaccination Coverage Among Adolescents (13–17 Years)*, to analyze vaccination trends, identify regional disparities, and develop predictive models for future vaccination rates. The ultimate goal is to uncover patterns in coverage gaps and provide actionable insights for public health interventions.

-   **Goals**: Understand factors influencing HPV vaccination coverage and predict future trends.

-   **Data**: [*Vaccination Coverage Among Adolescents (13–17 Years)*](https://data.cdc.gov/Teen-Vaccinations/Vaccination-Coverage-among-Adolescents-13-17-Years/ee48-w5t6/about_data) dataset.

-   **Faculty Consulted**:

    -   Dr. Fuchiang Tsui: Guided the selection of relevant factors and strategies to handle data complexity effectively.

    -   Dr. Jesse Hsu: Recommended statistical modeling approaches for analyzing disparities anad predicting trends.

## Introduction {#sec-introduction}

HPV vaccination is a vital preventative measure to reduce the risk of HPV-related cancers, yet vaccination rates across the U.S. exhibit considerable variability. These differences are influenced by geographic location and temporal trends, emphasizing the need for data-driven insights to understand and address gaps in coverage. For instance, certain states or regions may consistently lag in vaccination rates, potentially due to resource limitations or public health barriers.

This project focuses on analyzing temporal and geographic trends in HPV vaccination rates among adolescents aged 13–17 years using CDC’s Vaccination Coverage Among Adolescents dataset. Through descriptive and predictive modeling, this study aims to uncover actionable insights, identify high-risk regions, and forecast future vaccination trends. By combining statistical analysis and machine learning, this work provides a foundation for targeted public health interventions and emphasizes the importance of data-driven strategies in improving vaccination coverage.

## Methods {#sec-methods}

### 1. Load the Libraries:

In this project, several R libraries are utilized to perform data manipulation, visualization, and modeling. Below is an overview of the key libraries:

#### 1. **Tidyverse**

-   **Purpose:** The `tidyverse` is a collection of R packages designed for data science. It provides tools for data import, manipulation, visualization, and more.

-   **Key Functions Used:**

    -   `read_csv()`: Reads CSV files into R.

    -   `filter()`, `select()`, `mutate()`, `summarize()`: Used for data cleaning and transformation.

    -   `ggplot2` (part of the tidyverse): A powerful library for creating high-quality plots.

#### 2. **Arrow**

-   **Purpose:** The `arrow` package is used for handling large datasets efficiently by leveraging the Apache Arrow framework. It enables fast data serialization and processing.

-   **Key Functions Used:**

    -   `read_feather()`: Reads data stored in the feather format for quick access.

-   **When It's Used:** For larger datasets, the feather format speeds up data reading and writing compared to traditional CSV or text formats.

#### 3. **Gtsummary**

-   **Purpose:** The `gtsummary` package creates professional summary tables for data exploration and presentation.

-   **Key Functions Used:**

    -   `tbl_summary()`: Produces a summary table of variables, including counts and descriptive statistics.

    -   `add_p()`: Adds p-values to compare groups in a dataset.

-   **Why It’s Important:** These tables provide a quick overview of the data and highlight differences between groups.

#### 4. **GGplot2**

-   **Purpose:** Part of the tidyverse, `ggplot2` is used for creating sophisticated, customizable visualizations.

-   **Key Functions Used:**

    -   `geom_bar()`, `geom_boxplot()`, `geom_violin()`: Create bar plots, boxplots, and violin plots.

    -   `geom_point()`, `geom_smooth()`: Produce scatter plots and add smoothing lines.

    -   `labs()`, `theme()`: Enhance plots with labels, themes, and other customizations.

#### 5. **RandomForest**

-   **Purpose:** The `randomForest` package implements the Random Forest algorithm for classification and regression tasks.

-   **Key Functions Used:**

    -   `randomForest()`: Builds a Random Forest model.

    -   `importance()`: Calculates feature importance for interpretation.

-   **Why It’s Used:** Random Forest is a robust, non-linear machine learning algorithm that handles complex relationships and interactions in the data.

#### 6. **Caret**

-   **Purpose:** The `caret` package simplifies model training and evaluation for a wide range of machine learning algorithms.

-   **Key Functions Used:**

    -   `train()`: Trains models with different algorithms and hyperparameter tuning.

    -   `confusionMatrix()`: Evaluates model performance.

-   **Why It’s Used:** It streamlines the process of building and validating models, making it easier to compare different approaches.

#### 7. **DT**

-   **Purpose:** The `DT` package creates interactive tables in HTML documents.

-   **Key Functions Used:**

    -   `datatable()`: Generates tables that allow sorting, filtering, and searching.

-   **Why It’s Used:** Interactive tables make it easier for readers to explore data in the final report.

```{r}
#| eval: false

# Install necessary packages
install.packages(c("readr", "tidyverse", "caret", "randomForest", "ggplot2", "dplyr", "lubridate"))
```

```{r}
# Load packages
library(readr)
library(stringr)
library(tidyverse)
library(caret)
library(randomForest)
library(ggplot2)
library(dplyr)
library(lubridate)
```

### 2. Load the Dataset:

The dataset from the CDC, *Vaccination Coverage Among Adolescents (13–17 Years)*, provides HPV vaccination rates across different U.S. geographies and years. Updated on September 11, 2024, this dataset focuses on vaccination coverage trends over time and regional differences. Key variables include:

-   **Geography**: Specifies the location, including U.S. states, territories, or national-level aggregates.

-   **Geography Type**: Indicates the scope (e.g., state-level or national-level data).

-   **Survey Year**: The year the vaccination data was collected.

-   **Vaccination Measure**: Includes specific vaccination data points such as doses received (e.g., ≥1 dose of HPV vaccine) and total population coverage.

-   **Estimate (%)**: The vaccination coverage percentage for a given geography and measure.

-   **Confidence Interval (95% CI)**: Reflects the precision of the coverage estimate.

-   **Sample Size**: Total sample size used to calculate the vaccination rates

```{r}
# Load dataset
vaccination.data <- read_csv("Vaccination_Coverage_among_Adolescents__13-17_Years__20241121.csv")

names(vaccination.data)

# Filter for HPV vaccination data
unique(vaccination.data$vaccine.sample)

hpv.data <- vaccination.data |> 
  filter(str_detect(vaccine.sample, "HPV")) |> 
  select(dose, geography.type, geography, survey.year, estimate, ci, sample.size)

summary(hpv.data)
```

### 3. Data Cleaning:

The data will be cleaned to remove missing values and inconsistencies, and variables will be transformed where necessary.

```{r}
# Remove duplicate rows
hpv.data <- hpv.data |> 
  distinct()

# Drop rows with missing values
hpv.data <- hpv.data |> 
  drop_na()

# Convert columns to appropriate data types
hpv.data <- hpv.data |> 
  mutate(
    dose = as.character(dose),
    geography.type = as.factor(geography.type),
    geography = as.factor(geography),
    survey.year = as.integer(survey.year),
    estimate = as.numeric(estimate),
    ci = as.character(ci),
    sample.size = as.numeric(sample.size)
  )

# Standardize categorical variables
hpv.data <- hpv.data |> 
  mutate(
    geography.type = str_to_title(as.character(geography.type)),
    geography = str_to_title(as.character(geography))
  )

# Summary statistics to confirm no missing values and proper formatting
hpv.data |> 
  summarise(
    total_rows = n(),
    missing_estimate = sum(is.na(estimate)),
    missing_sample_size = sum(is.na(sample.size))
  )

summary(hpv.data)
```

### 4. Descriptive and Trend Analysis:

Summary statistics and visualizations (e.g., bar plots, histograms) will be used to explore patterns in vaccination rates.

```{r}
# Summary Statistics
hpv.data |> 
  summarise(
    mean_estimate = mean(estimate, na.rm = TRUE),
    median_estimate = median(estimate, na.rm = TRUE),
    sd_estimate = sd(estimate, na.rm = TRUE),
    min_estimate = min(estimate, na.rm = TRUE),
    max_estimate = max(estimate, na.rm = TRUE),
    mean_sample_size = mean(sample.size, na.rm = TRUE),
    median_sample_size = median(sample.size, na.rm = TRUE),
    sd_sample_size = sd(sample.size, na.rm = TRUE)
  )

# Count of unique categories
hpv.data |> 
  group_by(geography.type) |> 
  summarise(count = n()) |> 
  arrange(desc(count))

hpv.data |> 
  group_by(dose) |> 
  summarise(count = n()) |> 
  arrange(desc(count))

# Histogram of vaccination rates
ggplot(hpv.data, aes(x = estimate)) +
  geom_histogram(binwidth = 5, fill = "steelblue", color = "black") +
  labs(title = "Distribution of HPV Vaccination Rates", x = "Vaccination Rate (%)", y = "Frequency")

# Bar plot for geography types
ggplot(hpv.data, aes(x = geography.type)) +
  geom_bar(fill = "darkgreen") +
  labs(title = "Counts by Geography Type", x = "Geography Type", y = "Count") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Bar plot for doses
ggplot(hpv.data, aes(x = dose)) +
  geom_bar(fill = "purple") +
  labs(title = "Counts by Dose Type", x = "Dose", y = "Count") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

```{r}
# Average vaccination rates per year
trend.data <- hpv.data |> 
  group_by(survey.year, geography.type) |> 
  summarise(mean_estimate = mean(estimate, na.rm = TRUE))

# Smoothed trend plot
ggplot(trend.data, aes(x = survey.year, y = mean_estimate, color = geography.type)) +
  geom_line(size = 1) +
  geom_smooth(method = "loess", se = FALSE) +
  labs(title = "HPV Vaccination Trends Over Time by Geography Type",
       x = "Year",
       y = "Mean Vaccination Rate (%)") +
  theme_minimal()
```

### 4. Predictive Modeling

**Modeling:** A random forest algorithm will be applied to identify significant predictors of HPV vaccination coverage. This method was chosen for its robustness and ability to handle non-linear relationships and interactions between predictors. Feature importance analysis will highlight the most influential variables.

## Results {#sec-results}

**Exploratory Findings:**

**Modeling Results:**

**Visuals:**

## Discussion {#sec-discussion}

## Conclusion

This the conclusion. The @sec-results can be invoked here.

## References
